import{b as O,u as Q}from"./services-DL6wjq8D.js";import{a as I}from"./index-FacjB4mQ.js";import{g as w}from"./errorMessages-CmCcllaB.js";import{d as W,C as X,j as Y,c as R,a as m,l as t,i as a,t as o,x as s,E as d,R as T,k as Z,f as _,J as f,U as V,I as b,o as B,_ as ee}from"./index-QwL2gIV2.js";import"./axios-Cl3Sb8ms.js";const ae={class:"albums-view"},te={class:"albums-content card"},se={class:"search-filter"},le={class:"filter-buttons"},ne={class:"sort-controls"},oe={class:"sort-label"},re={key:0,class:"batch-operations"},de=["onClick"],ie=W({__name:"AlbumsView",setup(ce){const{t:e}=X(),x=_(!1),p=_({current:1,pageSize:10,total:0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:l=>e("pagination.total",{total:l})}),c=_([]),A=_([]),g=_(!1),h=_({}),D=_(""),y=_("created_at"),C=_("desc"),F=[{title:"ID",dataIndex:"id",key:"id"},{title:e("admin.albums.albumName"),dataIndex:"name",key:"name"},{title:e("admin.albums.albumDescription"),dataIndex:"description",key:"description"},{title:e("admin.albums.user"),key:"user_id",slots:{customRender:"user_id"}},{title:e("admin.albums.imageCount"),key:"image_count",dataIndex:"image_count"},{title:e("admin.albums.createdAt"),key:"created_at",slots:{customRender:"created_at"}},{title:e("admin.albums.updatedAt"),key:"updated_at",slots:{customRender:"updated_at"}},{title:e("admin.albums.actions"),key:"actions",slots:{customRender:"actions"}}],v=async()=>{try{x.value=!0;const l=await O.getAllAlbums({page:p.value.current,page_size:p.value.pageSize,searchkey:D.value,orderby:y.value,order:C.value});A.value=l.data.albums,p.value.total=l.data.total}catch(l){const n=l.response?.data?.code,i=n?w(n):e("admin.albums.fetchFailed");f.error(i)}finally{x.value=!1}},N=l=>{D.value=l,p.value.current=1,v()},U=()=>{p.value.current=1,v()},P=()=>{D.value="",y.value="created_at",C.value="desc",p.value.current=1,v()},E=l=>{p.value=l,v()},K=async l=>{try{const n=await Q.getUser(l);n&&(h.value=n.data||{},g.value=!0)}catch(n){const i=n.response?.data?.code,u=i?w(i):e("admin.albums.fetchUserFailed");f.error(u)}},z=()=>{g.value=!1,h.value={}},$=l=>{V.confirm({title:e("admin.albums.confirmDeleteTitle"),content:e("admin.albums.confirmDeleteContent"),onOk:async()=>{try{await O.deleteAdminAlbums([l]),f.success(e("admin.albums.deleteSuccess")),v()}catch(n){const i=n.response?.data?.code,u=i?w(i):e("admin.albums.deleteFailed");f.error(u)}}})},j=l=>{c.value=l},J=()=>{c.value.length!==0&&V.confirm({title:e("admin.albums.confirmBatchDeleteTitle"),content:e("admin.albums.confirmBatchDeleteContent",{count:c.value.length}),onOk:async()=>{try{await O.deleteAdminAlbums(c.value),f.success(e("admin.albums.batchDeleteSuccess")),c.value=[],v()}catch(l){const n=l.response?.data?.code,i=n?w(n):e("admin.albums.batchDeleteFailed");f.error(i)}}})};return Y(()=>{v()}),(l,n)=>{const i=b("a-input-search"),u=b("a-select-option"),M=b("a-select"),S=b("a-button"),L=b("a-table"),k=b("a-descriptions-item"),q=b("a-descriptions"),G=b("a-modal");return B(),R("div",ae,[m("div",te,[m("div",se,[t(i,{placeholder:a(e)("admin.albums.searchPlaceholder"),class:"search-input",onSearch:N},null,8,["placeholder"]),m("div",le,[m("div",ne,[m("span",oe,o(a(e)("admin.albums.sortLabel")),1),t(M,{value:y.value,"onUpdate:value":n[0]||(n[0]=r=>y.value=r),class:"sort-select",style:{width:"120px"},onChange:U},{default:s(()=>[t(u,{value:"created_at"},{default:s(()=>[d(o(a(e)("admin.albums.sortOptions.createdAt")),1)]),_:1}),t(u,{value:"updated_at"},{default:s(()=>[d(o(a(e)("admin.albums.sortOptions.updatedAt")),1)]),_:1}),t(u,{value:"name"},{default:s(()=>[d(o(a(e)("admin.albums.sortOptions.name")),1)]),_:1}),t(u,{value:"image_count"},{default:s(()=>[d(o(a(e)("admin.albums.sortOptions.imageCount")),1)]),_:1})]),_:1},8,["value"]),t(M,{value:C.value,"onUpdate:value":n[1]||(n[1]=r=>C.value=r),class:"sort-select",style:{width:"80px"},onChange:U},{default:s(()=>[t(u,{value:"desc"},{default:s(()=>[d(o(a(e)("admin.albums.sortOptions.desc")),1)]),_:1}),t(u,{value:"asc"},{default:s(()=>[d(o(a(e)("admin.albums.sortOptions.asc")),1)]),_:1})]),_:1},8,["value"])]),t(S,{type:"text",onClick:P},{default:s(()=>[d(o(a(e)("admin.albums.resetFilters")),1)]),_:1})])]),c.value.length>0?(B(),R("div",re,[m("span",null,o(c.value.length)+" "+o(a(e)("admin.albums.selectedCount")),1),t(S,{type:"primary",danger:"",onClick:J},{default:s(()=>[t(a(T)),d(" "+o(a(e)("admin.albums.batchDelete")),1)]),_:1})])):Z("",!0),t(L,{columns:F,"data-source":A.value,loading:x.value,pagination:p.value,onChange:E,"row-key":"id","row-selection":{selectedRowKeys:c.value,onChange:j,selections:[{key:"all-data",text:a(e)("admin.albums.selectAll"),onSelect:()=>{c.value=A.value.map(r=>r.id)}},{key:"clear",text:a(e)("admin.albums.clearSelection"),onSelect:()=>{c.value=[]}}]}},{user_id:s(({record:r})=>[m("a",{size:"small",onClick:H=>K(r.user_id)},o(r.user_id),9,de)]),created_at:s(({record:r})=>[m("span",null,o(a(I)(r.created_at)),1)]),updated_at:s(({record:r})=>[m("span",null,o(a(I)(r.updated_at)),1)]),actions:s(({record:r})=>[t(S,{type:"text",size:"small",danger:"",onClick:H=>$(r.id)},{default:s(()=>[t(a(T))]),_:1},8,["onClick"])]),_:1},8,["data-source","loading","pagination","row-selection"])]),t(G,{open:g.value,"onUpdate:open":n[2]||(n[2]=r=>g.value=r),title:a(e)("admin.albums.userPreviewTitle"),width:"40%",onCancel:z,onOk:z},{default:s(()=>[t(q,{column:1,bordered:"",size:"small"},{default:s(()=>[t(k,{label:a(e)("admin.albums.userId")},{default:s(()=>[d(o(h.value.id),1)]),_:1},8,["label"]),t(k,{label:a(e)("admin.albums.username")},{default:s(()=>[d(o(h.value.username),1)]),_:1},8,["label"]),t(k,{label:a(e)("admin.albums.email")},{default:s(()=>[d(o(h.value.email),1)]),_:1},8,["label"]),t(k,{label:a(e)("admin.albums.registerTime")},{default:s(()=>[d(o(a(I)(h.value.created_at)),1)]),_:1},8,["label"])]),_:1})]),_:1},8,["open","title"])])}}}),ve=ee(ie,[["__scopeId","data-v-dac36d9d"]]);export{ve as default};
