import{c as P}from"./services-DL6wjq8D.js";import{g as h}from"./errorMessages-Bb-gZ73b.js";import{d as N,C as A,j as H,c as G,a as d,l as s,x as n,s as R,i as t,t as i,E as q,f as g,H as z,J as b,I as m,o as _,_ as V}from"./index-DbrgNN6k.js";import"./axios-Cl3Sb8ms.js";const K={class:"system-view"},j={class:"system-content card"},D={class:"form-item-help"},J={class:"form-item-help"},L={class:"form-item-help"},O={class:"form-item-help"},Q={class:"form-item-help"},W={class:"form-item-help"},X={key:1,class:"loading-placeholder"},Y=N({__name:"SystemView",setup(Z){const{t:e}=A(),y=g(!1),v=g(!1),M=g(),f=g(["general"]),a=z({General:{MaxThumbSize:800,RegisterEnabled:!1,MaxTags:0},Mail:{Enabled:!1,ServerAddress:"",SMTP:{Host:"",Port:587,Username:"",Password:"",From:"",FromName:""}},Gallery:{Title:"Gallery",BackgroundImage:"",CustomContent:""}}),U={"Mail.SMTP.From":[{required:a.Mail.Enabled,message:()=>e("system.enterSenderEmail"),trigger:"blur"}],"Mail.SMTP.FromName":[{required:a.Mail.Enabled,message:()=>e("system.enterSenderName"),trigger:"blur"}],"Mail.SMTP.Host":[{required:a.Mail.Enabled,message:()=>e("system.enterSmtpServer"),trigger:"blur"}],"Mail.SMTP.Port":[{required:a.Mail.Enabled,message:()=>e("system.enterSmtpPort"),trigger:"blur"}],"Mail.SMTP.Username":[{required:a.Mail.Enabled,message:()=>e("system.enterSmtpUsername"),trigger:"blur"}],"Mail.SMTP.Password":[{required:a.Mail.Enabled,message:()=>e("system.enterSmtpPassword"),trigger:"blur"}]},k=async()=>{try{y.value=!0;const c=await P.getSystemInfo();Object.assign(a,c.data),v.value=!0}catch(c){const l=c.response?.data?.code,u=l?h(l):e("system.fetchFailed");b.error(u),v.value=!0}finally{y.value=!1}},x=async()=>{if(M.value)try{await M.value.validate(),y.value=!0,await P.updateSystemInfo(a),b.success(e("system.saveSuccess"))}catch(c){const l=c.response?.data?.code,u=l?h(l):e("system.saveFailed");b.error(u)}finally{y.value=!1}};return H(()=>{k()}),(c,l)=>{const u=m("a-input-number"),o=m("a-form-item"),T=m("a-switch"),S=m("a-collapse-panel"),p=m("a-input"),E=m("a-input-password"),w=m("a-textarea"),C=m("a-collapse"),F=m("a-button"),I=m("a-form"),B=m("a-spin");return _(),G("div",K,[d("div",j,[s(B,{spinning:y.value&&!v.value,tip:t(e)("system.loading")},{default:n(()=>[v.value?(_(),R(I,{key:0,model:a,rules:U,ref_key:"systemFormRef",ref:M,onFinish:x},{default:n(()=>[s(C,{activeKey:f.value,"onUpdate:activeKey":l[14]||(l[14]=r=>f.value=r)},{default:n(()=>[s(S,{key:"general",header:t(e)("system.general")},{default:n(()=>[s(o,{name:"General.MaxThumbSize",label:t(e)("system.maxThumbSize")},{default:n(()=>[s(u,{value:a.General.MaxThumbSize,"onUpdate:value":l[0]||(l[0]=r=>a.General.MaxThumbSize=r),min:300,max:2048},null,8,["value"]),d("span",D,i(t(e)("system.pixels")),1)]),_:1},8,["label"]),s(o,{name:"General.RegisterEnabled",label:t(e)("system.registerEnabled")},{default:n(()=>[s(T,{checked:a.General.RegisterEnabled,"onUpdate:checked":l[1]||(l[1]=r=>a.General.RegisterEnabled=r)},null,8,["checked"])]),_:1},8,["label"]),s(o,{name:"General.MaxTags",label:t(e)("system.maxTags")},{default:n(()=>[s(u,{value:a.General.MaxTags,"onUpdate:value":l[2]||(l[2]=r=>a.General.MaxTags=r),min:0},null,8,["value"]),d("span",J,i(t(e)("system.maxTagsHelp")),1)]),_:1},8,["label"])]),_:1},8,["header"]),s(S,{key:"mail",header:t(e)("system.mail")},{default:n(()=>[s(o,{name:"Mail.Enabled",label:t(e)("system.mailService")},{default:n(()=>[s(T,{checked:a.Mail.Enabled,"onUpdate:checked":l[3]||(l[3]=r=>a.Mail.Enabled=r)},null,8,["checked"]),d("span",L,i(t(e)("system.mailTooltip")),1)]),_:1},8,["label"]),s(o,{name:"Mail.ServerAddress",label:t(e)("system.serverAddress")},{default:n(()=>[s(p,{value:a.Mail.ServerAddress,"onUpdate:value":l[4]||(l[4]=r=>a.Mail.ServerAddress=r),placeholder:t(e)("system.enterServerAddress")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(o,{name:"Mail.SMTP.From",label:t(e)("system.senderEmail")},{default:n(()=>[s(p,{value:a.Mail.SMTP.From,"onUpdate:value":l[5]||(l[5]=r=>a.Mail.SMTP.From=r),placeholder:t(e)("system.enterSenderEmail")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(o,{name:"Mail.SMTP.FromName",label:t(e)("system.senderName")},{default:n(()=>[s(p,{value:a.Mail.SMTP.FromName,"onUpdate:value":l[6]||(l[6]=r=>a.Mail.SMTP.FromName=r),placeholder:t(e)("system.enterSenderName")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(o,{name:"Mail.SMTP.Host",label:t(e)("system.smtpServer")},{default:n(()=>[s(p,{value:a.Mail.SMTP.Host,"onUpdate:value":l[7]||(l[7]=r=>a.Mail.SMTP.Host=r),placeholder:t(e)("system.enterSmtpServer")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(o,{name:"Mail.SMTP.Port",label:t(e)("system.smtpPort")},{default:n(()=>[s(u,{value:a.Mail.SMTP.Port,"onUpdate:value":l[8]||(l[8]=r=>a.Mail.SMTP.Port=r),min:1,max:65535},null,8,["value"])]),_:1},8,["label"]),s(o,{name:"Mail.SMTP.Username",label:t(e)("system.smtpUsername")},{default:n(()=>[s(p,{value:a.Mail.SMTP.Username,"onUpdate:value":l[9]||(l[9]=r=>a.Mail.SMTP.Username=r),placeholder:t(e)("system.enterSmtpUsername")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(o,{name:"Mail.SMTP.Password",label:t(e)("system.smtpPassword")},{default:n(()=>[s(E,{value:a.Mail.SMTP.Password,"onUpdate:value":l[10]||(l[10]=r=>a.Mail.SMTP.Password=r),placeholder:t(e)("system.enterSmtpPassword")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["header"]),s(S,{key:"gallery",header:t(e)("system.gallery")},{default:n(()=>[s(o,{name:"Gallery.Title",label:t(e)("system.galleryTitle")},{default:n(()=>[s(p,{value:a.Gallery.Title,"onUpdate:value":l[11]||(l[11]=r=>a.Gallery.Title=r),placeholder:t(e)("system.enterGalleryTitle")},null,8,["value","placeholder"]),d("span",O,i(t(e)("system.galleryTitleTooltip")),1)]),_:1},8,["label"]),s(o,{name:"Gallery.BackgroundImage",label:t(e)("system.galleryBackgroundImage")},{default:n(()=>[s(p,{value:a.Gallery.BackgroundImage,"onUpdate:value":l[12]||(l[12]=r=>a.Gallery.BackgroundImage=r),placeholder:t(e)("system.enterGalleryBackgroundImage")},null,8,["value","placeholder"]),d("span",Q,i(t(e)("system.galleryBackgroundImageTooltip")),1)]),_:1},8,["label"]),s(o,{name:"Gallery.CustomContent",label:t(e)("system.galleryCustomContent")},{default:n(()=>[s(w,{value:a.Gallery.CustomContent,"onUpdate:value":l[13]||(l[13]=r=>a.Gallery.CustomContent=r),placeholder:t(e)("system.enterGalleryCustomContent"),rows:6},null,8,["value","placeholder"]),d("span",W,i(t(e)("system.galleryCustomContentTooltip")),1)]),_:1},8,["label"])]),_:1},8,["header"])]),_:1},8,["activeKey"]),s(o,null,{default:n(()=>[s(F,{type:"primary","html-type":"submit",loading:y.value,class:"save-button"},{default:n(()=>[q(i(t(e)("system.saveSettings")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])):(_(),G("div",X,[d("p",null,i(t(e)("system.loadingSettings")),1)]))]),_:1},8,["spinning","tip"])])])}}}),se=V(Y,[["__scopeId","data-v-640067e0"]]);export{se as default};
