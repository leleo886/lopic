import{d as I,C as R,f as p,D as T,c as B,a,l as n,y as l,E as w,t as d,i as s,G as b,z as N,H as U,I as i,o as q,J as k,_ as D}from"./index-DmJlHfzr.js";import{a as M}from"./services-DL6wjq8D.js";import{g as $}from"./errorMessages-Dl98_79z.js";import"./axios-Cl3Sb8ms.js";const j={class:"login-container"},G={class:"login-card"},H={class:"login-header"},J={class:"language-selector"},P={class:"login-title"},K={class:"login-subtitle"},O={class:"login-body"},Q={class:"login-links"},W={class:"login-footer"},X=I({__name:"LoginView",setup(Y){const{t:o}=R(),y=b("currentLanguage",p("zh")),C=b("changeLanguage",t=>{}),_=p(y.value),L=t=>{const e=t.target.value;_.value=e,C(e)},m=N(),x=T(),f=p(),v=p(!1),u=U({username:"",password:""}),z={username:[{required:!0,message:()=>o("login.username"),trigger:"blur"}],password:[{required:!0,message:()=>o("login.password"),trigger:"blur"}]},F=async()=>{if(f.value)try{await f.value.validate(),v.value=!0;const t=await M.login(u),e=t.data.user,g=t.data.token_response.access_token,h=t.data.token_response.refresh_token;localStorage.setItem("refresh_token",h),x.setAuth(e,g),k.success(o("login.loginSuccess")),m.push("/manage/dashboard")}catch(t){const e=t.response?.data?.code,g=e?$(e):o("login.loginFailed");k.error(g)}finally{v.value=!1}};return(t,e)=>{const g=i("a-radio-button"),h=i("a-radio-group"),S=i("a-input"),c=i("a-form-item"),V=i("a-input-password"),A=i("a-button"),E=i("a-form");return q(),B("div",j,[a("div",G,[a("div",H,[a("div",J,[n(h,{value:_.value,"onUpdate:value":e[0]||(e[0]=r=>_.value=r),onChange:L},{default:l(()=>[n(g,{value:"zh"},{default:l(()=>[...e[5]||(e[5]=[w("中文",-1)])]),_:1}),n(g,{value:"en"},{default:l(()=>[...e[6]||(e[6]=[w("English",-1)])]),_:1})]),_:1},8,["value"])]),a("h1",P,d(s(o)("login.title")),1),a("p",K,d(s(o)("login.subtitle")),1)]),a("div",O,[n(E,{model:u,rules:z,ref_key:"loginFormRef",ref:f,onFinish:F},{default:l(()=>[n(c,{name:"username",label:s(o)("login.username")},{default:l(()=>[n(S,{value:u.username,"onUpdate:value":e[1]||(e[1]=r=>u.username=r),placeholder:s(o)("login.username"),size:"large","prefix-icon":"user"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(c,{name:"password",label:s(o)("login.password")},{default:l(()=>[n(V,{value:u.password,"onUpdate:value":e[2]||(e[2]=r=>u.password=r),placeholder:s(o)("login.password"),size:"large","prefix-icon":"lock",visibilityToggle:""},null,8,["value","placeholder"])]),_:1},8,["label"]),n(c,null,{default:l(()=>[a("div",Q,[a("a",{onClick:e[3]||(e[3]=r=>s(m).push("/reset-password")),class:"password-reset-link"},d(s(o)("login.forgotPassword")),1)])]),_:1}),n(c,null,{default:l(()=>[n(A,{type:"primary","html-type":"submit",class:"login-button",size:"large",loading:v.value},{default:l(()=>[w(d(s(o)("login.login")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),a("div",W,[a("span",null,d(s(o)("login.noAccount")),1),a("a",{onClick:e[4]||(e[4]=r=>s(m).push("/register")),class:"login-link"},d(s(o)("login.register")),1)])])])])}}}),ae=D(X,[["__scopeId","data-v-1a6f0e63"]]);export{ae as default};
